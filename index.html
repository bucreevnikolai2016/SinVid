<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="contact form example">
<meta http-equiv="cache-control" content="max-age=0"/>
<meta http-equiv="cache-control" content="no-cache"/>
<meta http-equiv="expires" content="0"/>
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
<meta http-equiv="pragma" content="no-cache"/>
<title>СинВид</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<style>
body {
background-color: #000000;
}
.vid {
z-index: 0;
position: absolute;
width: 500px;
height: 281.25px;
left: 0px;
top: 0px;
}
.json {
position: absolute;
display : none;
}
</style>  	
	
</head>
	
<body>

<video class="vid" id="vid">
  <source src="" />
</video> 

<div style="display: none" class="json" id="json">json here</div>

<input id="ypr" style="display: none" name="ypr" value=""/> 

<script type="text/javascript">
    setInterval(function() { 
       var id = '1phPekCXWUAwnmWYzdmt0llykr0KR64rgXdWnx7mOLSw';
var gid = '0';
var url = 'https://docs.google.com/spreadsheets/d/'+id+'/gviz/tq?tqx=out:json&tq&gid='+gid;
fetch(url)
  .then(response => response.text())
  .then(data => document.getElementById("json").innerHTML=myItems(data.slice(47, -2))  
  );
function myItems(jsonString){
  var json = JSON.parse(jsonString);
  var table = '<table><tr>'
  json.table.cols.forEach(colonne => table += '<th>' + colonne.label + '</th>')
  table += '</tr>'
  json.table.rows.forEach(ligne => {
    table += '<tr>'
    ligne.c.forEach(cellule => {
        try{var valeur = cellule.f ? cellule.f : cellule.v}
        catch(e){var valeur = ''}
        table += '<td>' + valeur + '</td>'
      }
    )
    table += '</tr>'
    }
  )
  table += '</table>'
  return table
}
      }, 1000);
    </script> 

<script type="text/javascript">
  setInterval(function() {
if (document.getElementById("json")) {
  var p1 = json2.firstElementChild;
  var p2 = p1.firstElementChild;
  var p3 = p2.lastElementChild;
  var p4 = p3.lastElementChild;
  var p5 = p4.innerHTML;
  var p6 = p4.previousElementSibling;
  var p9 = p6.innerHTML;
  var p12 = p6.previousElementSibling;
  var p13 = p12.previousElementSibling;
  var p14 = p13.innerHTML;
  if (vid.paused) {
  var p10 = '0';
  } else {
  var p10 = '1';
  }
  var p11 = document.getElementById('ypr').value;
  if (document.getElementById('iden').value == 4) {
  if (p10 != p5 || p9 != p11) {
  if (p5 == 0) {
  vid.pause();
  vid.currentTime = p9;
  document.getElementById('ypr').value = p9;
  } 
  if (p5 == 1) {
  vid.play();
  vid.currentTime = p9;
  document.getElementById('ypr').value = p9;
  }
  }
  }
  }
  }
  }
}
          }, 10);
    </script> 

</body>	
	
</html>
